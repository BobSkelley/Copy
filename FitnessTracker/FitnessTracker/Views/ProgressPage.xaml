<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:microcharts="clr-namespace:Microcharts.Maui;assembly=Microcharts.Maui"
             xmlns:viewmodels="clr-namespace:FitnessTracker.ViewModels"
             x:DataType="viewmodels:ProgressViewModel"
             x:Class="FitnessTracker.Views.ProgressPage"
             Title="Progress">

    <ScrollView>
        <VerticalStackLayout Spacing="20" Padding="20">

            <Label 
                Text="Analytics Dashboard"
                Style="{StaticResource Headline}"
                Margin="0,20,0,0"
                HorizontalOptions="Center" />

            <ScrollView Orientation="Horizontal" HorizontalScrollBarVisibility="Never" HorizontalOptions="Center">
                <FlexLayout BindableLayout.ItemsSource="{Binding WeeklySummaries}"
                            Direction="Row"
                            Wrap="NoWrap"
                            JustifyContent="Center"
                            Padding="20,0">

                    <BindableLayout.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:WeeklySummary">
                            <Border StrokeShape="RoundRectangle 20" Padding="15" Background="{Binding Background}" HeightRequest="150" WidthRequest="250" Margin="7.5,0">
                                <Grid ColumnDefinitions="*,Auto">
                                    <VerticalStackLayout VerticalOptions="Center" Spacing="5">
                                        <Label Text="{Binding Title}" TextColor="White" FontSize="22" FontAttributes="Bold" />
                                        <Label Text="{Binding PrimaryMetric}" TextColor="White" FontSize="18" />
                                    </VerticalStackLayout>
                                    <microcharts:ChartView Grid.Column="1" Chart="{Binding Chart}" HeightRequest="100" WidthRequest="100" VerticalOptions="Center" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </BindableLayout.ItemTemplate>
                </FlexLayout>
            </ScrollView>

            <Border StrokeShape="RoundRectangle 20" 
                    Padding="30, 20" 
                    Margin="20" 
                    HorizontalOptions="Center">
                <VerticalStackLayout Spacing="10" HorizontalOptions="Center" VerticalOptions="Center">

                    <Image x:Name="HeartImage" Source="heart.png" HeightRequest="100" WidthRequest="100" />

                    <Label Text="{Binding AverageHeartRate}" FontSize="48" FontAttributes="Bold" HorizontalOptions="Center" />
                    <Label Text="Average BPM" FontSize="18" HorizontalOptions="Center" />

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>